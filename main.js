(()=>{"use strict";var t={995:(t,e,i)=>{var o,n=i(325),r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onInitialize=function(t){},e.prototype.onActivate=function(){},e.prototype.onDeactivate=function(){},e}(n.Scene),p=i(253),l=i(86),a=i(455),h={Sword:new n.Texture(p),Tile:new n.Texture(l),SpriteFont:new n.Texture(a)},c=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),u=function(t){function e(e,i,o,r){var s=t.call(this,{pos:(0,n.vec)(o,r),width:32,height:32,color:new n.Color(255,255,255)})||this;return s.speed=20,s.mergeAlignmentDistance=8,s.tileValue=i,s.body.collider.type=n.CollisionType.Active,s.label=new n.Label("n",o,r),s.on("precollision",(function(t){if(t.actor.hasOwnProperty("tileValue")&&t.other.hasOwnProperty("tileValue")){var e=t.actor,i=t.other;if(e.tileValue==i.tileValue){if(e.isMerged||i.isMerged)return;(Math.abs(e.pos.x-i.pos.x)<s.mergeAlignmentDistance||Math.abs(e.pos.y-i.pos.y)<s.mergeAlignmentDistance)&&(e.tileValue+=i.tileValue,i.tileValue=e.tileValue,i.body.collider.type=n.CollisionType.PreventCollision,i.isMerged=!0,i.mergedWith=e,i.mergeProgressCountdown=100,i.mergeOriginalPosition=i.pos.clone())}}})),s}return c(e,t),e.prototype.onInitialize=function(){this.addDrawing(h.Tile)},e.prototype.draw=function(e,i){this.isKilled()||(t.prototype.draw.call(this,e,i),this.label.draw(e,i))},e.prototype.update=function(e,i){if(!this.isKilled()){if(this.isMerged){if(this.mergeProgressCountdown<=0)return void this.kill();var o=this.mergeProgressCountdown/100;this.mergeProgressCountdown-=10;var r=(this.mergeOriginalPosition.x-this.mergedWith.pos.x)*o,s=(this.mergeOriginalPosition.y-this.mergedWith.pos.y)*o,p=this.mergedWith.pos.x+r,l=this.mergedWith.pos.y+s;this.pos.setTo(p,l)}else(e.input.keyboard.isHeld(n.Input.Keys.W)||e.input.keyboard.isHeld(n.Input.Keys.Up))&&this.accelerate(0,-1),(e.input.keyboard.isHeld(n.Input.Keys.S)||e.input.keyboard.isHeld(n.Input.Keys.Down))&&this.accelerate(0,1),(e.input.keyboard.isHeld(n.Input.Keys.A)||e.input.keyboard.isHeld(n.Input.Keys.Left))&&this.accelerate(-1,0),(e.input.keyboard.isHeld(n.Input.Keys.D)||e.input.keyboard.isHeld(n.Input.Keys.Right))&&this.accelerate(1,0);this.label.pos.x=this.pos.x-4,this.label.pos.y=this.pos.y+4,this.label.text=this.tileValue.toString(),t.prototype.update.call(this,e,i)}},e.prototype.onPostUpdate=function(e,i){this.pos.x<this.width/2&&(this.vel.x=0,this.pos.x=this.width/2),this.pos.x+this.width/2>e.drawWidth&&(this.vel.x=0,this.pos.x=e.drawWidth-this.width/2),this.pos.y<this.height/2&&(this.vel.y=0,this.pos.y=this.height/2),this.pos.y+this.height/2>e.drawHeight&&(this.vel.y=0,this.pos.y=e.drawHeight-this.height/2),t.prototype.onPostUpdate.call(this,e,i)},e.prototype.accelerate=function(t,e){this.vel.setTo(this.vel.x+this.speed*t,this.vel.y+this.speed*e)},e}(n.Actor),d=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),y=new(function(t){function e(){var e=t.call(this,{displayMode:n.DisplayMode.FullScreen,width:128,height:128})||this;return e.pointerIsDown=!1,e}return d(e,t),e.prototype.start=function(){var e=this;this.tiles=[],this.levelOne=new s(this);for(var i=0;i<9;i++)this.addTileOnGrid();this.font=new n.SpriteFont({image:h.SpriteFont,alphabet:"0123456789abcdefghijklmnopqrstuvwxyz,!'&.\"?- ",caseInsensitive:!0,columns:16,rows:3,spWidth:16,spHeight:16}),this.newTileTimer=new n.Timer({fcn:function(){console.log("new tile"),e.addTileOnGrid()},interval:1e3,repeats:!0}),this.screen.resolution={width:256,height:256},this.levelOne.add(this.newTileTimer),this.add("levelOne",this.levelOne),this.input.keyboard.on("release",(function(t){t.key==n.Input.Keys.Space&&e.addTileOnGrid()})),this.input.pointers.primary.on("down",(function(t){e.pointerIsDown=!0,e.lastKnownPointerPosition=t.worldPos})),this.input.pointers.primary.on("up",(function(t){e.pointerIsDown=!1}));var o=new n.Loader(Object.values(h));return t.prototype.start.call(this,o)},e.prototype.onPostUpdate=function(t,e){if(this.pointerIsDown){var i=this.lastKnownPointerPosition,o=this.getWorldBounds(),n=o.width/3,r=o.height/3,s=0,p=0;if(i.x>2*n?s=1:i.x<n&&(s=-1),i.y>2*r?p=1:i.y<r&&(p=-1),0!=s||0!=p)for(var l=0,a=this.tiles.filter((function(t){return!t.isKilled()}));l<a.length;l++){a[l].accelerate(s,p)}}},e.prototype.addTileOnGrid=function(){if(!(this.tiles.filter((function(t){return!t.isKilled()})).length>64)){var t=Math.random()*this.canvasWidth,e=Math.random()*this.canvasHeight,i=Math.pow(2,Math.floor(3*Math.random())),o=new u(y,i,t,e);this.levelOne.add(o),this.tiles.push(o)}},e}(n.Engine));y.start().then((function(){y.goToScene("levelOne")}))},455:(t,e,i)=>{t.exports=i.p+"da6089e93350f5ada412.png"},253:(t,e,i)=>{t.exports=i.p+"0377c07b4b240a97b8a9.png"},86:(t,e,i)=>{t.exports=i.p+"76295a5b2c3a7623a2d5.png"}},e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={exports:{}};return t[o](n,n.exports,i),n.exports}i.m=t,i.x=t=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={179:0},e=[[995,325]],o=t=>{},n=(n,r)=>{for(var s,p,[l,a,h,c]=r,u=0,d=[];u<l.length;u++)p=l[u],i.o(t,p)&&t[p]&&d.push(t[p][0]),t[p]=0;for(s in a)i.o(a,s)&&(i.m[s]=a[s]);for(h&&h(i),n&&n(r);d.length;)d.shift()();return c&&e.push.apply(e,c),o()},r=self.webpackChunkexcalibur_webpack=self.webpackChunkexcalibur_webpack||[];function s(){for(var o,n=0;n<e.length;n++){for(var r=e[n],s=!0,p=1;p<r.length;p++){var l=r[p];0!==t[l]&&(s=!1)}s&&(e.splice(n--,1),o=i(i.s=r[0]))}return 0===e.length&&(i.x(),i.x=t=>{}),o}r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r));var p=i.x;i.x=()=>(i.x=p||(t=>{}),(o=s)())})(),i.x()})();
//# sourceMappingURL=main.js.map